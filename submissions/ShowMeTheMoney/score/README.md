### ICONWithU Score

ICONWithu is consisted of `withu_manager` score managing service user and deploying score and token,
`withu_wedding` score receiving wedding invitation and money gift and token `withu_token` score.



#### How to deploy

First, install `t-bears`  to begin with service.

( If it is not installed, follow the guide at [t-bears](https://github.com/icon-project/t-bears).)

To deploy score using `t-bears`, `tbears_cli_config.json`  config file is needed generated by `tbears genconf` order.
Let's deploy score if you are ready.



##### withu_token

To deploy withu_token, you need name, symbol, amount and decimals parameters.

Input each parameter's data at "deploy.scoreParams" option as follows. 

```json
{
    "uri": "http://127.0.0.1:9000/api/v3",
    "nid": "0x3",
    "keyStore": null,
    "from": "hxe7af5fcfd8dfc67530a01a0e403882687528dfcb",
    "to": "cx0000000000000000000000000000000000000000",
    "deploy": {
        "stepLimit": "0x87000000",
        "mode": "install",
        "scoreParams": {
            "name":"WithU",
            "symbol":"WTU",
            "amount": "0x2540be400",
            "decimals": "0x12"
        }
    },
    "txresult": {},
    "transfer": {
        "stepLimit": "0xf4240"
    }
}
```

After you write config file as above, execute order as follows.

```sh
tbears deploy withu_token -c token_deploy.json
```

If deploy request succeeds, following message comes up.

```sh
Send deploy request successfully.
If you want to check SCORE deployed successfully, execute txresult command
transaction hash: 0xb1c29df5957137bfbdb5de524e43f6683282bdb984ecda87d0dc1e96088c4ef4
```

You can check the result with following order.

```sh
tbears txresult 0xb1c29df5957137bfbdb5de524e43f6683282bdb984ecda87d0dc1e9088c4ef4
```

You can check request result and scoreAddress deployed.

```json
Transaction result: {
    "jsonrpc": "2.0",
    "result": {
        "txHash": "0xb1c29df5957137bfbdb5de524e43f6683282bdb984ecda87d0dc1e96088c4ef4",
        "blockHeight": "0xd93",
        "blockHash": "0x02d9921034fdaa3e2ae22220a073fed76f9c93714cda26751e8b15026fe60df1",
        "txIndex": "0x0",
        "to": "cx0000000000000000000000000000000000000000",
        "scoreAddress": "cxe7f5a6f28e64338d5260914852f14de165f5805e",
        "stepUsed": "0x3267e80",
        "stepPrice": "0x0",
        "cumulativeStepUsed": "0x3267e80",
        "eventLogs": [],
        "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "status": "0x1"
    },
    "id": 1
}
```



##### withu_manager

To deploy withu_manager, token score address which is generated from above and exchange_rate are needed.

exchange_rate is exchange ratio between icx and token and if the ratio is 1:1, set exchange_rate as 100000.

```json
{
    "uri": "http://127.0.0.1:9000/api/v3",
    "nid": "0x3",
    "keyStore": null,
    "from": "hxe7af5fcfd8dfc67530a01a0e403882687528dfcb",
    "to": "cx0000000000000000000000000000000000000000",
    "deploy": {
        "stepLimit": "0x87000000",
        "mode": "install",
        "scoreParams": {
            "token_score":"cxe7f5a6f28e64338d5260914852f14de165f5805e",
            "exchange_rate":"0x186a0"
        }
    },
    "txresult": {},
    "transfer": {
        "stepLimit": "0xf4240"
    }
}
```

After you write config file, execute order as follows.

```sh
tbears deploy withu_manager -c manager_deploy.json 
```

After execution, look up `txresult` with transaction hash to check deployed score address.

```json
{
    "jsonrpc": "2.0",
    "result": {
        "txHash": "0x0581fd76be0884fcce5b23f13ee8cfb562587cbb30f5c683c305290a5f895cf7",
        "blockHeight": "0xe57",
        "blockHash": "0x23c43e1ca07cd7ef06cf1bbc2b43c401d67b1b814d9f6a16e72aa007f46e30ed",
        "txIndex": "0x0",
        "to": "cx0000000000000000000000000000000000000000",
        "scoreAddress": "cx89ac98dd8addb2b23f2d675fa43e8f10397ae28a",
        "stepUsed": "0x3eda230",
        "stepPrice": "0x0",
        "cumulativeStepUsed": "0x3eda230",
        "eventLogs": [],
        "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        "status": "0x1"
    },
    "id": 1
}
```



##### withu_wedding

To deploy withu_wedding, information_json, manager_score, meal_ticket_count and public_key are needed. 

You need information_json to write wedding invitation and it is formed as follows.

```json
{
 "groom_name":"0xec8ba0eb9e91",
 "groom_father_name":"0xec8ba0eb9e91ec9584ebb284eca780",
 "groom_mother_name":"0xec8ba0eb9e91ec96b4eba8b8eb8b88",
 "bride_name":"0xec8ba0ebb680",
 "bride_father_name":"0xec8ba0ebb680ec9584ebb284eca780",
 "bride_mother_name":"0xec8ba0ebb680ec96b4eba8b8eb8b88",
 "invitation_message":"0xecb488eb8c80ec9db8ec82aceba790",
 "wedding_date":"0x57aea006358c0",
 "wedding_date_str":"0x57aea006358c0",
 "wedding_place_name":"0xeab2b0ed98bcec8b9dec9ea5",
 "wedding_place_address":"0xeab2b0ed98bcec8b9deca3bcec868c",
 "wedding_photo_url":"0xec82aceca78455524c"
}
```

Input withu_manager address which is deployed above for manager_score.

meal_ticket_count is meal ticket quantity and public_key is publicKey data used for encrypting guest's name.

```json
{
  "public_key": "...", 
  "meal_ticket_count": "0x1f4", 
  "information_json": "...", 
  "manager_score": "cx89ac98dd8addb2b23f2d675fa43e8f10397ae28a"
}
```





